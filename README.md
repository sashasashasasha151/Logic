Условая задач: https://github.com/shd/logic2018/blob/master/hw-practice.pdf

100% работающий код только на котлине

Задача 0. Разбор выражения
Стоимость: 0 баллов, решение на Ocaml или Haskell: 0 баллов
Данная задача разобрана, решения её приведены (см. README.md), однако, мы крайне рекомендуем
написать своё её решение по двум причинам: (а) разбор высказываний можно будет
переиспользовать в других задачах; (б) можно протестировать среду исполнения на Яндексе.
На вход программе (в файле input.txt) подаётся выражение в следующей грамматике:
hфайлi ::= hвыражениеi
hвыражениеi ::= hдизъюнкцияi | hдизъюнкцияi‘->’hвыражениеi
hдизъюнкцияi ::= hконъюнкцияi | hдизъюнкцияi‘|’hконъюнкцияi
hконъюнкцияi ::= hотрицаниеi | hконъюнкцияi‘&’hотрицаниеi
hотрицаниеi ::= (‘A’ . . . ‘Z’) {‘A’ . . . ‘Z’ | ‘0’ . . . ‘9’}
∗
| ‘!’hотрицаниеi | ‘(’hвыражениеi‘)’
Пробелы, символы табуляции и переноса строки должны игнорироваться. Символ ‘|’ имеет
ASCII-код 12410.
Написать программу, разбирающую выражение и строящую его дерево разбора, и выводящую
полученное дерево в файл output.txt в следующей грамматике.
hфайлi ::= hвершинаi
hвершинаi ::= ‘(’hзнакi‘,’hвершинаi‘,’hвершинаi‘)’
| ‘(!’hвершинаi‘)’
| (‘A’ . . . ‘Z’) {‘A’ . . . ‘Z’ | ‘0’ . . . ‘9’}
∗
hзнакi ::= ‘&’ | ‘|’ | ‘->’
Пример входного файла:
P->!QQ->!R10&S|!T&U&V
Выходной файл для данного входного файла:
(->,P,(->,(!QQ),(|,(&,(!R10),S),(&,(&,(!T),U),V))))